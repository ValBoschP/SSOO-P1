# Opciones por defecto.

#!/bin/bash

# script_1 - Un script que informa algunos datos del sistema

##### Constantes

TITLE="Información del sistema para $HOSTNAME"

RIGHT_NOW=$(date +"%x %r%Z")
TIME_STAMP="Actualizada el $RIGHT_NOW por $USER"


##### Estilos
TEXT_BOLD=$(tput bold)
TEXT_ULINE=$(tput smul)

##### Colores
TEXT_RED=$(tput setaf 1)
TEXT_GREEN=$(tput setaf 2)
TEXT_YELLOW=$(tput setaf 3)
TEXT_BLUE=$(tput setaf 4)

##### Reset Text
TEXT_RESET=$(tput sgr0)

interactive=
filename=./sysinfo.txt

##### Funciones


system_info()
{
   echo "${TEXT_ULINE}${TEXT_BOLD}${TEXT_RED}Versión del sistema${TEXT_RESET}"
   uname -a
   echo
   return 0
}


show_uptime()
{
   echo "${TEXT_ULINE}${TEXT_BOLD}${TEXT_YELLOW}Tiempo de encendido del sistema$TEXT_RESET"
   uptime
   echo
   return 0
}


drive_space()
{
   echo "${TEXT_ULINE}${TEXT_BOLD}${TEXT_GREEN}Espacio ocupado por los discos$TEXT_RESET"
   df
   echo
   return 0
}


home_space()
{
   echo "${TEXT_ULINE}${TEXT_BOLD}${TEXT_BLUE}Espacio ocupado por cada uno de los subdirectorios$TEXT_RESET"
   if  [ "$USER" != root ]; then
      echo "${TEXT_BOLD}${TEXT_RED}ERROR: No tienes permisos de Superusuario! :($TEXT_RESET"
      return 1
   fi
   du -sh /home/*/
   return 0
}

##### Programa principal


usage()
{
   echo "usage: sysinfo [-f filename] [-i] [-h]"

}


write_page()

{

    # El script-here se puede indentar dentro de la función si

    # se usan tabuladores y "<<-EOF" en lugar de "<<".

    cat << _EOF_

$TEXT_BOLD$TITLE$TEXT_RESET


$(system_info)

$(show_uptime)

$(drive_space)

$(home_space)


$TEXT_GREEN$TIME_STAMP$TEXT_RESET

_EOF_

}


# Procesar la línea de comandos del script para leer las opciones
while [ "$1" != "" ]; do
   case $1 in
       -f | --file )

            shift
           filename=$1
           ;;
       -i | --interactive )

            interactive=1

            ;;
       -h | --help )

            usage
           exit
           ;;
       * )

            usage
           exit 1
   esac
   shift
done


# Generar el informe del sistema y guardarlo en el archivo indicado

# en $filename

write_page > $filename